
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Gradient Descent in practice &#8212; Machine Learning in Particle Physics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Classification algorithms" href="class_algs.html" />
    <link rel="prev" title="Learning Rate" href="warmup_1D_learningR.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Machine Learning in Particle Physics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Machine Learning in Particle Physics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About the course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about/learningoutcomes.html">
   Learning outcomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../about/jupyter.html">
   JupyterHub for class
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 1
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="trailer.html">
   1. Course Trailer
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="trailer_hep.html">
     From detectors to publications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trailer_mldef.html">
     What is Machine Learning?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trailer_pb.html">
     Which problems does ML solve?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="warmup_1D.html">
   2. Warm up: Linear Regression
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="warmup_1D_linRegGD.html">
     Gradient Descent in 1D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="warmup_1D_linRegGDmulti.html">
     Multivariate linear regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="warmup_1D_learningR.html">
     Learning Rate
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Gradient Descent in practice
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="class_algs.html">
   3. Classification algorithms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="class_algs_logReg.html">
     Logistic Regression: introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="class_algs_sigmoid.html">
     What is the Sigmoid Function?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="class_algs_costF.html">
     Cost Function for Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="class_algs_reg.html">
     Regularization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="class_algs_biasV.html">
     Bias, Variance: how to cope
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="BDTs.html">
   4. Decision Trees and Boosting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="BDTs_def.html">
     What are Decision Trees?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="BDTs_forest.html">
     Ensemble Learning and Random Forests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="BDTs_boosting.html">
     What is boosting?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="review_week1.html">
   5. Review Week 1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week2/NN1.html">
   6. Neural Networks Part I
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN1_motivations.html">
     Motivations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN1_modelRep.html">
     Model Representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN1_activationF.html">
     Activation Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN1_feedforward.html">
     Feedforward Propagation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week2/NN2.html">
   7. Neural Networks Part II
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN2_costF.html">
     Neural Network Cost Function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN2_backprop.html">
     Backpropagation Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN2_gradCheck.html">
     Initialization and checks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/NN2_trainNN.html">
     Let’s train our NN!
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week2/DL.html">
   8. Towards Deep Learning Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/DL_stochGD.html">
     Stochastic Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/DL_adaptLR.html">
     Adaptative Learning Rates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/DL_paramHyper.html">
     Hyperparameters in DL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/DL_scikitPyT.html">
     Tools: scikit-learn &amp; PyTorch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week2/CNN.html">
   8. Convolutional Neural Networks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/CNN_architecture.html">
     Architecture of a CNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/CNN_hyperparameters.html">
     Hyperparameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/CNN_regMethods.html">
     Regularization Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/CNN_neutrinoReco.html">
     Application in Neutrino Physics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week2/GNN.html">
   9. Graph Neural Networks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/GNN_defGraph.html">
     What is a Graph?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/GNN_applications.html">
     Applications of GNNs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/GNN_messagePassing.html">
     Message Passing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week2/GNN_GConvoN.html">
     Graph Convolutional Networks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week2/review_week2.html">
   10. Review Week 2
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 3
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week3/unsupervised_learning.html">
   11. Unsupervised learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/unsupervised_learning_motiv.html">
     Motivations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/unsupervised_learning_relevance.html">
     Relevance and examples
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/unsupervised_learning_k-Means.html">
     k-Means Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/unsupervised_learning_dimRed.html">
     Dimensionality Reduction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week3/PCA_AD.html">
   12. PCA and Anomaly Detection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/PCA_AD_PCA.html">
     Principal Component Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/PCA_AD_autoEncoder.html">
     Autoencoders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/PCA_AD_VAE_for_AD.html">
     Variational Autoencoder for Anomaly Detection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week3/ML_BigData.html">
   13. ML in Big Data &amp; Strategies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/ML_BigData_7Vs.html">
     The 7V’s of Big Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/ML_BigData_preproc.html">
     Data Preprocessing Pipelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/ML_BigData_chooseAlgo.html">
     How to Choose an Optimization Algorithm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week3/ethics_exam.html">
   14. Ethics in ML &amp; Exam
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/ethics_exam_1.html">
     The Ethics in ML
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/ethics_exam_2.html">
     Course Exam
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../week3/projects_outlook.html">
   15. Project presentations &amp; Outlook
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/projects_outlook_pres.html">
     Project Presentations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../week3/projects_outlook_today.html">
     Open Questions in ML today
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t01_python.html">
   1. Python: io, variables &amp; plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t02_dataprep_linReg.html">
   2. Data Prep &amp; Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t03_signalDisc_LHC.html">
   3. Classification at the LHC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t04_BDT_workflow.html">
   4. BDT Implementation &amp; Workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t05_nn.html">
   5. Neural Networks by hand
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t06_scikitPyTorch.html">
   6. Intro to scikit-Learn &amp; PyTorch
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t07_CNN_protoDUNE.html">
   7. CNN in protoDUNE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t08_GNN_CMS.html">
   8. GNN at the LHC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t09_k-Means.html">
   9. k-Means for Data Quality Monitoring
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/t10_anomaly_det.html">
   10. Anomaly Detection for Long-Lived Particle Searches
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fweek1/warmup_1D_practice.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/week1/warmup_1D_practice.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adjusting-the-learning-rate">
   Adjusting the learning rate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-graph-to-visualize-the-cost-s-evolution">
   A graph to visualize the cost’s evolution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#knowing-when-to-stop">
   Knowing when to stop
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Gradient Descent in practice</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adjusting-the-learning-rate">
   Adjusting the learning rate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-graph-to-visualize-the-cost-s-evolution">
   A graph to visualize the cost’s evolution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#knowing-when-to-stop">
   Knowing when to stop
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="gradient-descent-in-practice">
<h1>Gradient Descent in practice<a class="headerlink" href="#gradient-descent-in-practice" title="Permalink to this headline">#</a></h1>
<p>How to choose a correct learning rate?</p>
<p>Short answer: inspect your gradient descent cost function.</p>
<p>Long answer:</p>
<section id="adjusting-the-learning-rate">
<h2>Adjusting the learning rate<a class="headerlink" href="#adjusting-the-learning-rate" title="Permalink to this headline">#</a></h2>
<p>It is always a good programming practice to add in your code printouts, i.e. <code class="docutils literal notranslate"><span class="pre">print()</span></code> statements to inspect the current values of your variables.
In gradient descent, it is advised to print the values of the parameters and the cost function after some iterations. Here is an example of printouts of simple linear regression showing the values of updates parameters <span class="math notranslate nohighlight">\(\theta\)</span> every 10 epochs until <span class="math notranslate nohighlight">\(N\)</span> = 100, then every 100 epochs:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>Starting gradient descent

Iteration <span class="m">10</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">23</span>.360	<span class="nv">Diff</span> <span class="o">=</span> -0.2486		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">1</span>.158		<span class="nv">Diff</span> <span class="o">=</span> -0.5069		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">34</span>.1274
Iteration <span class="m">20</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">21</span>.784	<span class="nv">Diff</span> <span class="o">=</span> -0.1703		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">1</span>.590		<span class="nv">Diff</span> <span class="o">=</span> -0.0918		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">27</span>.7958
Iteration <span class="m">30</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">20</span>.339	<span class="nv">Diff</span> <span class="o">=</span> -0.1423		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">1</span>.847		<span class="nv">Diff</span> <span class="o">=</span> -0.0041		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">23</span>.4581
Iteration <span class="m">40</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">19</span>.028	<span class="nv">Diff</span> <span class="o">=</span> -0.1262		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">2</span>.052		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0133		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">19</span>.9476
Iteration <span class="m">50</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">17</span>.841	<span class="nv">Diff</span> <span class="o">=</span> -0.1136		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">2</span>.230		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0157		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">17</span>.0769
Iteration <span class="m">60</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">16</span>.767	<span class="nv">Diff</span> <span class="o">=</span> -0.1027		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">2</span>.390		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0150		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">14</span>.7278
Iteration <span class="m">70</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">15</span>.795	<span class="nv">Diff</span> <span class="o">=</span> -0.0929		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">2</span>.535		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0138		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">12</span>.8055
Iteration <span class="m">80</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">14</span>.916	<span class="nv">Diff</span> <span class="o">=</span> -0.0840		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">2</span>.666		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0125		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">11</span>.2325
Iteration <span class="m">90</span>		<span class="nv">theta_0</span> <span class="o">=</span> <span class="m">14</span>.121	<span class="nv">Diff</span> <span class="o">=</span> -0.0760		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">2</span>.784		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0113		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">9</span>.9453
Iteration <span class="m">200</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">9</span>.083	<span class="nv">Diff</span> <span class="o">=</span> -0.0252		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.534		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0038		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.7867
Iteration <span class="m">300</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">7</span>.499	<span class="nv">Diff</span> <span class="o">=</span> -0.0093		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.770		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0014		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.2340
Iteration <span class="m">400</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.917	<span class="nv">Diff</span> <span class="o">=</span> -0.0034		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.856		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0005		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1596
Iteration <span class="m">500</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.704	<span class="nv">Diff</span> <span class="o">=</span> -0.0012		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.888		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0002		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1496
Iteration <span class="m">600</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.626	<span class="nv">Diff</span> <span class="o">=</span> -0.0005		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.900		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0001		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1483
Iteration <span class="m">700</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.597	<span class="nv">Diff</span> <span class="o">=</span> -0.0002		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.904		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0000		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1481
Iteration <span class="m">800</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.587	<span class="nv">Diff</span> <span class="o">=</span> -0.0001		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.905		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0000		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1481
Iteration <span class="m">900</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.583	<span class="nv">Diff</span> <span class="o">=</span> -0.0000		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.906		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0000		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1480
Iteration <span class="m">1000</span>		<span class="nv">theta_0</span> <span class="o">=</span>  <span class="m">6</span>.581	<span class="nv">Diff</span> <span class="o">=</span> -0.0000		<span class="nv">theta_1</span> <span class="o">=</span> <span class="m">3</span>.906		<span class="nv">Diff</span> <span class="o">=</span> <span class="m">0</span>.0000		<span class="nv">Cost</span> <span class="o">=</span> <span class="m">4</span>.1480

End of gradient descent after <span class="m">1000</span> iterations
</pre></div>
</div>
<p>Picking a learning rate is a guess’n’check business.</p>
<p>Typical learning rates are between <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(10^{-7}\)</span>. The common practice is to start with e.g. <span class="math notranslate nohighlight">\(\alpha = 0.01\)</span>, a reasonable number of epochs, e.g. <span class="math notranslate nohighlight">\(N = 100\)</span> or <span class="math notranslate nohighlight">\(1000\)</span> (depending on the size of the data set), and see how the gradient descent behaves.</p>
<p><strong>The cost function should decrease after every iteration.</strong> If the printouts show that the cost function and parameter are taking very, very large values: <span class="math notranslate nohighlight">\(\alpha\)</span> is too big, the gradient descent is diverging! One should reduce the learning rate by e.g. a factor 10 and see how the gradient behaves.</p>
<p>If the cost decreases after each iteration, this is a good sign that the gradient will converge. However it can converge very slowly if <span class="math notranslate nohighlight">\(\alpha\)</span> is too small, and as a consequence necessitate a large number of epoch before reaching the optimized parameter values. While tuning the hyperparameters, it is generally good to cap the number of epochs low and inspect the difference <span class="math notranslate nohighlight">\(\Delta \theta = \theta^\text{new} - \theta^\text{prev}\)</span> to see if the relative increment or decrement with respect to the <span class="math notranslate nohighlight">\(\theta\)</span> value is small. There is a bit of tweaking before finding a correct learning rate.</p>
</section>
<section id="a-graph-to-visualize-the-cost-s-evolution">
<h2>A graph to visualize the cost’s evolution<a class="headerlink" href="#a-graph-to-visualize-the-cost-s-evolution" title="Permalink to this headline">#</a></h2>
<p>To inspect the gradient descent algorithm, it is convenient to store the intermediary values of the cost function and plot them with the iteration number on the <span class="math notranslate nohighlight">\(x\)</span> axis. The resulting curve should be strictly decreasing. Below is an example with different learning rates being plotted:</p>
<figure class="align-default" id="lec02-4-cost-vs-learning-rates">
<a class="reference internal image-reference" href="../_images/lec02_4_Cost_vs_learning_rates.png"><img alt="../_images/lec02_4_Cost_vs_learning_rates.png" src="../_images/lec02_4_Cost_vs_learning_rates.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">. The learning rate plays a crucial role on the gradient’s speed towards convergence.<br />
<sub>Credits: <a class="reference external" href="https://jonathan-hui.medium.com/debug-a-deep-learning-network-part-5-1123c20f960d">Jonathan Hui Medium</a></sub></span><a class="headerlink" href="#lec02-4-cost-vs-learning-rates" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="seealso admonition">
<p class="admonition-title">Exercise</p>
<p>For each learning rate situation above, illustrate with a plot (qualitative drawing) the corresponding evolution of <span class="math notranslate nohighlight">\(\theta\)</span> parameters.</p>
</div>
</section>
<section id="knowing-when-to-stop">
<h2>Knowing when to stop<a class="headerlink" href="#knowing-when-to-stop" title="Permalink to this headline">#</a></h2>
<p>In mathematics, zero is exactly zero. In computing, variables can store very small numbers considered zero but with trailing non-zero digits. A good cutoff to declare the gradient descent algorithm successful is to exit when e.g. the cost function’s relative decrease is lower than a given threshold, for instance <span class="math notranslate nohighlight">\(10^{-6}\)</span>.</p>
<div class="success admonition">
<p class="admonition-title">Summary</p>
<p><strong>Linear Regression</strong> is the procedure that estimate a real-valued dependent variable (target) from independent variables (input features) assuming a linear relationship between <span class="math notranslate nohighlight">\(n\)</span> input features and <span class="math notranslate nohighlight">\(n+1\)</span> coefficients (parameters, or weight). The extra one is the offset parameter.</p>
<p><strong>The cost function</strong>, or loss function, computes the sum of errors between the predicted line and the data. It usually uses the least squared method (errors squared).</p>
<p><strong>The Gradient Descent</strong> is an optimization algorithm consisting of an iterative procedure to update the parameters in the direction of ‘descending gradient’, i.e. dictated by the slope of the cost function’s partial derivatives for each parameter, until convergence to values for the parameters minimizing the cost function.</p>
<p><strong>Hyperparameters</strong> are quantitative entities controlling the learning algorithm.</p>
<p><strong>The learning rate</strong> for gradient descent is an important hyperparameter that should be tuned to avoid divergence or over-shooting (learning rate too large) or slow convergence (learning rate too small) necessitating a high number of iterations (epochs).</p>
</div>
<p>The linear regression was our starting model. Later in this course, we will see more complex machine learning algorithms able to model non-linear behaviour. Linearity is an assumption that should be made with care.</p>
<figure class="align-default" id="lec02-4-xkcd-sustainable">
<a class="reference internal image-reference" href="../_images/lec02_4_xkcd_sustainable.png"><img alt="../_images/lec02_4_xkcd_sustainable.png" src="../_images/lec02_4_xkcd_sustainable.png" style="width: 95%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">. A questionable linear extrapolation, from the great webcomic <a class="reference external" href="https://xkcd.com/1007/">xkcd</a>.</span><a class="headerlink" href="#lec02-4-xkcd-sustainable" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="warmup_1D_learningR.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Learning Rate</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="class_algs.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3. Classification algorithms</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Claire David<br/>
  
      &copy; Copyright 2022.<br/>
    <div class="extra_footer">
      <div>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://licensebuttons.net/l/by-nc-sa/3.0/88x31.png"></a>
    All content on this site (unless otherwise specified) is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 license</a>
</div>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>